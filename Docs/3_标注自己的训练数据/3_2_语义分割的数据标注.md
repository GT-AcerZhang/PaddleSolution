## 3.2.1 使用LabelMe标注自己的数据

***步骤一 准备工作***   
- 对收集的图像划分为训练、验证（非必须）、测试三个部分的数据集，分别存放于对应的文件夹中      
- 创建与图像文件夹相对应的文件夹，用于存储标注的json文件
- 点击”Open Dir“按钮，选择需要标注的图像所在的文件夹打开，则”File List“对话框中会显示所有图像所对应的绝对路径      

***步骤二 标注***           
- 点击右侧的“Create Polygons”以打点的方式圈出目标的轮廓，具体如下提所示：
<div align=center><img width="800" height="450" src="./pics/detection4.gif"/></div>    

当框标注错误时，可点击右侧的“Edit Polygons”再点击标注框，通过拖拉进行修改，也可再点击“Delete Polygon”进行删除。

- 点击右侧”Save“，将标注结果保存到步骤一中创建的文件夹中



## 3.2.2 对LabelMe标注数据的转换
语义分割中常用的数据集是CityScape，由于LabelMe标注的数据与CityScape数据集所需的格式不一致，所以需要将LabelMe数据集转换为CityScape数据集格式。      
CityScape的数据目录结构如下：
```
data/mydataset/
|-- gtFine
|   |-- test
|   |-- train
|   |-- val
|-- leftImg8bit
    |-- test
    |-- train
    |-- val
```      
针对训练、验证（非必须）、测试三个部分的数据集，分别在命令行中执行下述命令进行转换：
```cmd
# 进入Anaconda环境后，安装下述python包
# 安装numpy
pip install numpy
# 安装PIL
pip install Pillow
# 转换
cd ./DataAnnotation
python ./labelme2cityscape.py \
       --json_input_dir ~/Users/json/ \
       --output_dir ~/Users/cityscape/ \
# --json_input_dir：LabelMe所标注文件的文件夹路径
# --output_dir：最终转换的文件的存放路径

```
转换后的CityScape格式为每张图像对应一个.json文件，将训练、验证（非必须）、测试的转换结果，分别放入gtFine的train/val/test中，同时将各个文件夹下json文件所对应的图像文件分别放入leftImg8bit的train/val/test中。          
转换后的.json文件的合适如下所示：
```
{
    "imgHeight": 1024,
    "imgWidth": 2048,
    "objects": [
        {
            "label": "building",
            "polygon": [
                [
                    0,
                    0
                 ],
                 [
                    0,
                    507
                  ],
                  ...
              ]
         }
    ]
}       
```
相关标签含义:

|标签|备注|
|-----|-----|
|objects| 目标信息的列表|
|label| 目标类别|
|polygon| 目标坐标的列表，有多边形点的所有坐标组成|
|imageHeight| 图像高度|
|imageWidth| 图像宽度|
